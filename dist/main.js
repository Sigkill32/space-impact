(()=>{"use strict";const e={START_GAME:"END",STOP_GAME:"START"};function t(e,t,n){return function(s,i){e.beginPath(),e.rect(s,i,t,n),e.fillStyle="black",e.fill(),e.closePath()}}const n=function(e,n){const s=t(e,15,15),i=t(e,20,10);s(n.myShip.x,n.myShip.y),i(n.enemyShip.x,n.enemyShip.y);const o=Object.keys(n.bullets);o.length&&o.forEach((t=>{!function(e,t,n){e.beginPath(),e.rect(t,n,2,10),e.fillStyle="black",e.fill(),e.closePath()}(e,n.bullets[t].x,n.bullets[t].y)}))},s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),i=new Worker("BulletsWorks.js"),o=document.getElementById("gameCanvas"),c=document.querySelector(".SpaceImpact_GameToggle"),l=window.innerHeight,u=window.innerWidth;o.setAttribute("width",u-50),o.setAttribute("height",Math.floor(.8*l));const h=o.getContext("2d"),a=o.width,r=o.height,d=(new class{events={};subscribe=(e,t)=>{this.events[e]?this.events[e].push(t):this.events[e]=[t]};publish=(e,t)=>{this.events[e]&&this.events[e].forEach((e=>{e.call(this,t)}))}},{myShip:{x:Math.floor(a/2),y:r-30},enemyShip:{x:a/2,y:0},bullets:{}});let m="STOP_GAME";function y(){h.clearRect(0,0,a,r),n(h,d)}function S(e){let{clientX:t}=e;s&&(t=e.changedTouches[0].clientX),d.myShip.x=t-25,y()}function g(e){let{type:t,clientX:n}=e;s&&(n=e.changedTouches[0].clientX),"mousedown"!==t&&"touchstart"!==t||(d.myShip.x=n-25,y(),o.addEventListener(s?"touchmove":"mousemove",S)),"mouseup"!==t&&"touchend"!==t||o.removeEventListener(s?"touchmove":"mousemove",S)}function b(e){d.bullets[e].y-=5,y(),d.bullets[e].y>=0?requestAnimationFrame((()=>b(e))):(delete d.bullets[e],y())}function p(){const e=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)));d.bullets[e]={x:d.myShip.x+7.5,y:d.myShip.y},y(),b(e)}n(h,d),o.addEventListener(s?"touchstart":"mousedown",g),o.addEventListener(s?"touchend":"mouseup",g),i.onmessage=function(e){const{data:t}=e;switch(t){case"SHOOT_BULLET":p();break;case"END_GAME":console.log("game ended")}},c.addEventListener("click",(()=>{m="START_GAME"===m?"STOP_GAME":"START_GAME",i.postMessage(m),c.textContent=e[m]}))})();